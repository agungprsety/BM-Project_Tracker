import{E as I,a as w}from"./vendor-pdf-D-ScUWta.js";import{i as T,c as v,f as P,a as z,j as V,k as p,l as N}from"./utils-DGZViaHi.js";const i={primary:[37,99,235],dark:[17,24,39],medium:[75,85,99],light:[243,244,246],green:[22,163,74],amber:[217,119,6],white:[255,255,255]};function L(t,e,n){const r=t.internal.pageSize.getWidth();return t.setFillColor(...i.primary),t.rect(0,0,r,40,"F"),t.setTextColor(...i.white),t.setFontSize(20),t.setFont("helvetica","bold"),t.text(e,14,18),n&&(t.setFontSize(10),t.setFont("helvetica","normal"),t.text(n,14,28)),t.setFontSize(9),t.text(`Generated: ${new Date().toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"})}`,14,36),t.setFontSize(10),t.setFont("helvetica","bold"),t.text("SigiMarga",r-14,18,{align:"right"}),48}function A(t){const e=t.getNumberOfPages();for(let n=1;n<=e;n++){t.setPage(n);const r=t.internal.pageSize.getWidth(),o=t.internal.pageSize.getHeight();t.setDrawColor(...i.light),t.line(14,o-18,r-14,o-18),t.setFontSize(8),t.setTextColor(...i.medium),t.setFont("helvetica","normal"),t.text("SigiMarga â€” Confidential",14,o-10),t.text(`Page ${n} of ${e}`,r-14,o-10,{align:"right"})}}function b(t,e,n){return t.setFontSize(13),t.setFont("helvetica","bold"),t.setTextColor(...i.dark),t.text(e,14,n),t.setDrawColor(...i.primary),t.setLineWidth(.8),t.line(14,n+2,80,n+2),n+10}function u(t,e,n,r,o,y=40){return t.setFontSize(9),t.setFont("helvetica","bold"),t.setTextColor(...i.medium),t.text(e,r,o),t.setFont("helvetica","normal"),t.setTextColor(...i.dark),t.text(n||"-",r+y,o),o+6}function B(t,e,n,r,o){t.setFillColor(...i.light),t.roundedRect(e,n,r,6,2,2,"F");const C=Math.min(r,o/100*r);return C>0&&(t.setFillColor(...i.primary),t.roundedRect(e,n,C,6,2,2,"F")),t.setFontSize(7),t.setFont("helvetica","bold"),t.setTextColor(...i.dark),t.text(`${o.toFixed(1)}%`,e+r+4,n+5),n+6+6}function Q(t){const e=new I("p","mm","a4");let n=L(e,"All Projects Summary Report",`${t.length} projects`);const r=t.reduce((g,c)=>g+T(c.boq||[]),0),o=t.length>0?t.reduce((g,c)=>g+v(c.boq||[],c.weeklyReports||[]),0)/t.length:0,y=t.reduce((g,c)=>g+(c.length||0),0);n=b(e,"Summary Statistics",n);const C=[["Total Projects",String(t.length)],["Total Contract Value",P(r)],["Average Progress",`${o.toFixed(1)}%`],["Total Road Length",z(y)]];e.setFontSize(9),C.forEach(([g,c],l)=>{const S=l%2,m=Math.floor(l/2),h=14+S*90,s=n+m*12;e.setFillColor(...i.light),e.roundedRect(h,s,82,10,2,2,"F"),e.setFont("helvetica","normal"),e.setTextColor(...i.medium),e.text(g,h+3,s+7),e.setFont("helvetica","bold"),e.setTextColor(...i.dark),e.text(c,h+79,s+7,{align:"right"})}),n+=Math.ceil(C.length/2)*12+8,n=b(e,"Projects Overview",n);const k=t.map((g,c)=>{var m;const l=v(g.boq||[],g.weeklyReports||[]),S=T(g.boq||[]);return[String(c+1),g.name,g.contractor,((m=g.workType)==null?void 0:m.replace("-"," "))||"-",`${l.toFixed(1)}%`,P(S),z(g.length)]});w(e,{startY:n,head:[["#","Project Name","Contractor","Type","Progress","Contract Value","Length"]],body:k,theme:"grid",headStyles:{fillColor:i.primary,textColor:i.white,fontStyle:"bold",fontSize:8,cellPadding:3},bodyStyles:{fontSize:8,cellPadding:2.5,textColor:i.dark},alternateRowStyles:{fillColor:[248,250,252]},columnStyles:{0:{cellWidth:8,halign:"center"},1:{cellWidth:40},4:{halign:"right"},5:{halign:"right"},6:{halign:"right"}},margin:{left:14,right:14}}),A(e),e.save("All_Projects_Summary.pdf")}function _(t){var R;const e=new I("p","mm","a4"),n=e.internal.pageSize.getWidth(),r=t.boq||[],o=t.weeklyReports||[],y=T(r),C=V(o),k=v(r,o),g=r.reduce((f,a)=>{const d=Math.min(C[a.id]||0,a.quantity);return f+d*a.unitPrice},0),c=(t.length||0)*(t.averageWidth||0);let l=L(e,t.name,"Project Detail Report");l=b(e,"Project Information",l);const S=14,m=110;let h=l,s=l;if(h=u(e,"Contractor:",t.contractor,S,h),h=u(e,"Supervisor:",t.supervisor,S,h),h=u(e,"Work Type:",((R=t.workType)==null?void 0:R.replace("-"," "))||"-",S,h),h=u(e,"Road Hierarchy:",t.roadHierarchy||"-",S,h),h=u(e,"Maintenance:",t.maintenanceType||"-",S,h),s=u(e,"Start Date:",p(t.startDate),m,s),s=u(e,"End Date:",p(t.endDate),m,s),s=u(e,"Length:",z(t.length),m,s),s=u(e,"Avg. Width:",t.averageWidth?`${t.averageWidth} m`:"-",m,s),s=u(e,"Area:",N(c),m,s),t.district&&(s=u(e,"District:",t.district,m,s)),t.subDistrict&&(s=u(e,"Sub-district:",t.subDistrict,m,s)),l=Math.max(h,s)+4,l=b(e,"Financial Summary",l),[["Total Contract Value",P(y),i.primary],["Completed Value",P(g),i.green],["Remaining Value",P(y-g),i.amber]].forEach(([f,a,d])=>{e.setFillColor(d[0],d[1],d[2]),e.roundedRect(14,l,4,8,1,1,"F"),e.setFontSize(9),e.setFont("helvetica","normal"),e.setTextColor(...i.medium),e.text(f,22,l+5),e.setFont("helvetica","bold"),e.setTextColor(...i.dark),e.text(a,n-14,l+5,{align:"right"}),l+=10}),l+=2,l=B(e,14,l,n-58,k),l+=4,r.length>0){l=b(e,"Bill of Quantities (BoQ)",l);const f=r.map((a,d)=>[a.itemNumber,a.description,a.unit,a.quantity.toLocaleString("id-ID"),`Rp ${a.unitPrice.toLocaleString("id-ID")}`,`Rp ${(a.quantity*a.unitPrice).toLocaleString("id-ID")}`]);f.push(["","","","","TOTAL",P(y)]),w(e,{startY:l,head:[["Item #","Description","Unit","Qty","Unit Price","Total"]],body:f,theme:"grid",headStyles:{fillColor:i.primary,textColor:i.white,fontStyle:"bold",fontSize:8,cellPadding:3},bodyStyles:{fontSize:8,cellPadding:2.5,textColor:i.dark},alternateRowStyles:{fillColor:[248,250,252]},columnStyles:{0:{cellWidth:18},1:{cellWidth:55},2:{cellWidth:15,halign:"center"},3:{halign:"right"},4:{halign:"right"},5:{halign:"right"}},margin:{left:14,right:14},didParseCell:a=>{a.row.index===f.length-1&&(a.cell.styles.fontStyle="bold",a.cell.styles.fillColor=i.light)}}),l=e.lastAutoTable.finalY+8}if(r.length>0&&o.length>0){l>220&&(e.addPage(),l=20),l=b(e,"Cumulative Progress per Item",l);const f=r.map(a=>{const d=C[a.id]||0,W=a.quantity>0?Math.min(100,d/a.quantity*100):0;return[a.itemNumber,a.description,`${d.toLocaleString("id-ID")} / ${a.quantity.toLocaleString("id-ID")}`,a.unit,`${W.toFixed(1)}%`]});w(e,{startY:l,head:[["Item #","Description","Completed / Contract","Unit","Progress"]],body:f,theme:"grid",headStyles:{fillColor:i.primary,textColor:i.white,fontStyle:"bold",fontSize:8,cellPadding:3},bodyStyles:{fontSize:8,cellPadding:2.5,textColor:i.dark},alternateRowStyles:{fillColor:[248,250,252]},columnStyles:{0:{cellWidth:18},1:{cellWidth:60},2:{halign:"right"},3:{cellWidth:15,halign:"center"},4:{halign:"right"}},margin:{left:14,right:14}}),l=e.lastAutoTable.finalY+8}if(o.length>0){l>220&&(e.addPage(),l=20),l=b(e,"Weekly Reports",l);const f=o.sort((a,d)=>a.weekNumber-d.weekNumber).map(a=>{var $,q;const d=(($=a.itemProgress)==null?void 0:$.reduce((F,x)=>{const D=r.find(H=>H.id===x.boqItemId);return F+(D?x.quantity*D.unitPrice:0)},0))||0,W=y>0?d/y*100:0,M=((q=a.itemProgress)==null?void 0:q.map(F=>{const x=r.find(D=>D.id===F.boqItemId);return x?`${x.itemNumber}: ${F.quantity} ${x.unit}`:""}).filter(Boolean).join(", "))||"-";return[`Week ${a.weekNumber}`,`${p(a.startDate)} - ${p(a.endDate)}`,a.workDescription||"-",M,`+${W.toFixed(1)}%`]});w(e,{startY:l,head:[["Week","Period","Description","Item Progress","+%"]],body:f,theme:"grid",headStyles:{fillColor:i.primary,textColor:i.white,fontStyle:"bold",fontSize:8,cellPadding:3},bodyStyles:{fontSize:7,cellPadding:2.5,textColor:i.dark},alternateRowStyles:{fillColor:[248,250,252]},columnStyles:{0:{cellWidth:18},1:{cellWidth:35},2:{cellWidth:35},4:{cellWidth:14,halign:"right"}},margin:{left:14,right:14}})}A(e),e.save(`${t.name.replace(/[^a-zA-Z0-9]/g,"_")}_Report.pdf`)}export{_ as a,Q as e};
